!function(t,e){"use strict";"function"==typeof define&&define.amd?define(e):"object"==typeof module&&"object"==typeof module.exports?module.exports=e():t.LazyLoad=e()}(this,function(){"use strict";function e(){this.cbList={}}function t(t){this.options=t,this.imgList=[].slice.call(document.querySelectorAll(".lazyload-img")),this.loadFailedImgList=[],this.watcher=new e,this.init()}return e.prototype.listen=function(t,e){this.cbList[t]||(this.cbList[t]=[]),this.cbList[t].push(e)},e.prototype.trigger=function(t){for(var e=0;e<this.cbList[t].length;e++)this.cbList[t][e]();this.cbList[t]=null},t.prototype.init=function(){var o=this;if("function"==typeof(new Image).getBoundingClientRect){var t=null,e="function"==typeof o.options.complete?o.options.complete:function(){},i=o.options.delay?o.options.delay:100;s(),function(t){for(var e=t.length,i=0;i<e;i++){var o=t[i].elem,n=t[i].type,s=t[i].cb;o.addEventListener(n,s,!1)}}([{elem:document,type:"scroll",cb:s},{elem:window,type:"resize",cb:s}]),o.watcher.listen("clear-reference",function(){document.removeEventListener("scroll",s),window.removeEventListener("resize",s),e(),o=null})}else{console.log("您的浏览器版本过低！");for(var n=0;n<o.imgList.length;n++)o.imgList[n].onerror=function(t){o.loadFailedImgList.push(o.imgList[n])},o.imgList[n].src=o.imgList[n].getAttribute("data-src"),o.imgList[n].removeAttribute("data-src"),o.imgList=[]}function s(){t&&clearTimeout(t),t=setTimeout(function(){for(var t=[],e=o.imgList.length,i=0;i<e;i++)o.isInViewport(o.imgList[i])&&t.push(o.imgList[i]);o.loadImg(t)},i)}},t.prototype.isInViewport=function(t){var e,i,o,n,s,r=document.documentElement.clientHeight,c=document.documentElement.clientWidth,l=this.options.spaceH||0,u=this.options.spaceW||0;return n=(e=t.getBoundingClientRect()).top,o=e.left,i=e.height,s=e.width,-i-l<n&&n<r+l&&-s-u<o&&o<c+u},t.prototype.loadImg=function(t){for(var e=t.length,i="",o=this,n=0;n<e;n++)i=t[n].getAttribute("data-src"),t[n].onerror=function(t){o.loadFailedImgList.push(this)},t[n].src=i,t[n].removeAttribute("data-src"),o.removeImgLoaded(t[n])},t.prototype.removeImgLoaded=function(t){var e=this.imgList.indexOf(t);-1<e&&this.imgList.splice(e,1),0===this.imgList.length&&this.watcher.trigger("clear-reference")},t});